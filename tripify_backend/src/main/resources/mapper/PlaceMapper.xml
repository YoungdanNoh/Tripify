<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.trip.place.mapper.placeMapper">

	<select id="getSido" resultType="sidoGugunCode">
		select sido_code, sido_name
		from sidos
		order by sido_code
	</select>
	
	<select id="getGugunInSido" parameterType="string" resultType="sidoGugunCode">
		select gugun_code, gugun_name
		from guguns
		where guguns.sido_code = #{sido}
		order by gugun_code
	</select>
	
	<select id="typeSelect" resultType="Type">
		select * 
		from contenttypes;
	</select>
	
	<sql id="search">
		<if test="sido != null and sido != ''">
			and area_code = #{sido}
		</if>
		<if test="gugun != null and gugun != ''">
			and si_gun_gu_code = #{gugun}
		</if>
		<if test="type != null and type != ''">
			and content_type_id = #{type}
		</if>
		<if test="word != null and word != ''">
			and title like concat('%', #{word}, '%')
		</if>
	</sql>
	
	<select id="listAttr" parameterType="map" resultType="Places">
		select no, content_id, title,content_type_id, area_code, si_gun_gu_code, latitude, longitude, addr1, addr2, first_image1, count
		from places
		where 1=1
		<include refid="search"></include>
		order by no
		limit #{start}, #{listsize}
	</select>
	
	<select id="getTotalAttrCount" parameterType="map" resultType="int">
		select count(no)
		from places
		where 1=1
		<include refid="search"></include>
	</select>
	
</mapper>